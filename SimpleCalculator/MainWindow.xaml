<Window x:Class="SimpleCalculator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:selector="clr-namespace:SimpleCalculator.TemplateSelector"
        FontSize="14"
        FontFamily="Consolas"
        WindowStartupLocation="CenterScreen"
        Title="Simple Calculator"
        Icon="/Resources/Images/icon.png"
        Foreground="{Binding Configuration.Theme.PrimaryForegroundColor}"
        Background="{Binding Configuration.Theme.PrimaryBackgroundColor}">

    <Window.Resources>

        <selector:CodeStyleSelector x:Key="CodeStyleSelector" />

        <Style x:Key="LabelTextBlockStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{Binding DataContext.Configuration.Theme.SecondaryForegroundColor, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}" />
            <Setter Property="Margin" Value="1" />
        </Style>

        <Style x:Key="NoSelectItemContainerStyle" TargetType="ListViewItem">
            
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListViewItem">
                        <Grid Background="{TemplateBinding Background}">
                            <ContentPresenter />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            
        </Style>

    </Window.Resources>
    
    <Grid Background="Transparent">
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="32" />
        </Grid.RowDefinitions>
        
        <!-- Menu -->
        <Menu Background="{Binding DataContext.Configuration.Theme.SecondaryBackgroundColor, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}">
            <MenuItem x:Name="ConfigurationMI" Header="_Configuration" Click="ConfigurationMI_Click" />
            <MenuItem x:Name="AboutMI" Header="_About" Click="AboutMI_Click" />
        </Menu>

        <!-- Primary Notepad -->
        <ListView x:Name="NotepadLV"                  
                  Grid.Row="1"
                  IsTabStop="False"
                  Background="Transparent"
                  ItemsSource="{Binding OutputLog}"
                  ItemContainerStyleSelector="{StaticResource CodeStyleSelector}">
            <!--ListView.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" Margin="2">
                        <TextBlock Text="> " 
                                   Style="{StaticResource CodeTextBlockStyle}"
                                   Visibility="{Binding IsAnswer, Converter={StaticResource BoolInverseVisibilityCollapseConverter}}" />
                        
                        <TextBox Text="{Binding Message}" 
                                 Style="{StaticResource CodeTextBoxStyle}"
                                 IsReadOnly="True" 
                                 IsTabStop="False"
                                 BorderThickness="0">
                        </TextBox>
                    </StackPanel>
                </DataTemplate>
            </ListView.ItemTemplate-->
        </ListView>

        <!-- Primary Input -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="32" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <TextBlock x:Name="InputDecorationTB" Text=">" FontSize="24" TextAlignment="Center" HorizontalAlignment="Center" />
            <TextBox x:Name="InputTB" Grid.Column="1" VerticalContentAlignment="Center" FontSize="14" PreviewKeyDown="InputTB_PreviewKeyDown" />
        </Grid>

        <!-- Sidebar -->
        <Grid RowDefinitions="Auto, *, Auto, *, Auto, *" 
              Background="{Binding Configuration.Theme.SecondaryBackgroundColor}"
              MinWidth="300"
              Grid.Column="1" 
              Grid.RowSpan="3">

            <TextBlock Text="Constants" Style="{StaticResource LabelTextBlockStyle}" />

            <ListView x:Name="ConstantsLV" 
                      Grid.Row="1"
                      IsTabStop="False"
                      Focusable="False"                      
                      Foreground="{Binding Configuration.Theme.SecondaryForegroundColor}"
                      Background="{Binding Configuration.Theme.SecondaryBackgroundColor}"
                      ItemContainerStyle="{StaticResource NoSelectItemContainerStyle}"
                      ItemsSource="{Binding Configuration.Constants}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid ColumnDefinitions="Auto, Auto, *">
                            <TextBlock Text="{Binding Symbol}" />
                            <TextBlock Text="=" Grid.Column="1" />
                            <TextBlock Text="{Binding Value}" Grid.Column="2" />
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <TextBlock Text="Variables" Grid.Row="2" Style="{StaticResource LabelTextBlockStyle}" />

            <ListView x:Name="VariablesLV" 
                      Grid.Row="3"
                      IsTabStop="False"
                      Focusable="False"                      
                      Foreground="{Binding Configuration.Theme.SecondaryForegroundColor}"
                      Background="{Binding Configuration.Theme.SecondaryBackgroundColor}"
                      ItemContainerStyle="{StaticResource NoSelectItemContainerStyle}"
                      ItemsSource="{Binding Configuration.Variables}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid ColumnDefinitions="Auto, Auto, *">
                            <TextBlock Text="{Binding Symbol}" />
                            <TextBlock Text="=" Grid.Column="1" />
                            <TextBlock Text="{Binding Value}" Grid.Column="2" />
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <TextBlock Text="Functions" Grid.Row="4" Style="{StaticResource LabelTextBlockStyle}" />

            <ListView x:Name="FunctionsLV" 
                      Grid.Row="5"
                      IsTabStop="False"
                      Focusable="False"
                      Foreground="{Binding Configuration.Theme.SecondaryForegroundColor}"
                      Background="{Binding Configuration.Theme.SecondaryBackgroundColor}"
                      ItemContainerStyle="{StaticResource NoSelectItemContainerStyle}"
                      ItemsSource="{Binding Configuration.Functions}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Expression}" />
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>

    </Grid>
</Window>
